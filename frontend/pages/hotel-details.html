<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InnStay - Property Details</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/index.css">
    <style>
        body {
            background: #f7f7f7;
        }
        .property-details-page {
            padding: 20px 0;
        }
        .details-content {
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar sticky-top">
        <div class="navbar-container">
            <div class="navbar-left">
                <a href="../index.html" class="navbar-logo">
                    <span class="logo-icon">üè†</span>
                    <span class="logo-text">InnStay</span>
                </a>
            </div>
            <div class="navbar-center">
                <a href="../index.html" class="nav-link">Stays</a>
                <a href="#" class="nav-link">Experiences</a>
                <a href="#" class="nav-link">Online Experiences</a>
            </div>
            <div class="navbar-right">
                <button class="navbar-search-btn" onclick="document.getElementById('searchBar').style.display = 'block'">
                    <i class="fas fa-search"></i>
                </button>
                <button class="navbar-menu" id="menuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div id="menuDropdown" class="navbar-dropdown">
                    <a href="../pages/login.html" class="dropdown-item">
                        <span>Login</span>
                    </a>
                    <a href="../pages/register.html" class="dropdown-item">
                        <span>Sign up</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Property Details Container -->
    <div class="property-details-page">
        <div class="details-content">
            <!-- Image Gallery -->
            <div class="details-image-gallery" id="imageGallery">
                <img id="mainImage" src="" alt="Property" class="main-image">
                <div class="thumbnail-images" id="thumbnails"></div>
            </div>
            
            <!-- Property Info -->
            <div class="details-info" style="padding: 40px; max-width: 1200px; margin: 0 auto;">
                <div class="details-header">
                    <div>
                        <h1 id="propertyTitle" style="font-size: 32px; margin-bottom: 10px;"></h1>
                        <p id="propertyLocation" class="location" style="font-size: 18px; color: #484848; margin-bottom: 10px;"></p>
                        <div class="rating-section" style="margin-bottom: 20px;">
                            <span id="ratingStars" class="stars" style="color: #FF6E1A; font-size: 16px;"></span>
                            <span id="ratingReviews" style="margin-left: 10px;"></span>
                        </div>
                    </div>
                    <div class="price-section" style="text-align: right;">
                        <span id="propertyPrice" class="price" style="font-size: 24px; font-weight: bold;"></span>
                        <span>/night</span>
                    </div>
                </div>
                
                <!-- Rooms Info -->
                <div class="rooms-info" style="padding: 20px 0; border-bottom: 1px solid #e0e0e0; margin-bottom: 30px; font-size: 16px;">
                    <span id="bedrooms"></span> ‚Ä¢ <span id="beds"></span> ‚Ä¢ <span id="bathrooms"></span> ‚Ä¢ <span id="guests"></span>
                </div>
                
                <!-- Description -->
                <div class="description-section" style="margin-bottom: 40px;">
                    <h3 style="font-size: 22px; margin-bottom: 15px;">About this place</h3>
                    <p id="propertyDescription" style="font-size: 16px; line-height: 1.6; color: #484848;"></p>
                </div>
                
                <!-- Amenities -->
                <div class="amenities-section" style="margin-bottom: 40px;">
                    <h3 style="font-size: 22px; margin-bottom: 20px;">What this place offers</h3>
                    <div id="amenitiesList" class="amenities-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;"></div>
                </div>
                
                <!-- Host Info -->
                <div class="host-section" style="padding: 20px; background: #f5f5f5; border-radius: 12px; margin-bottom: 40px;">
                    <h3 style="font-size: 22px; margin-bottom: 20px;">Meet your host</h3>
                    <div class="host-card" style="display: flex; gap: 20px;">
                        <img id="hostPhoto" src="" alt="Host" class="host-photo" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
                        <div class="host-info">
                            <h4 id="hostName" style="font-size: 18px; font-weight: bold; margin: 5px 0;"></h4>
                            <p id="hostBadge" style="margin: 5px 0; color: #484848;"></p>
                            <p id="hostDetails" style="margin: 5px 0; color: #484848;"></p>
                            <p id="hostResponse" style="margin: 5px 0; color: #484848;"></p>
                        </div>
                    </div>
                </div>
                
                <!-- Ratings Breakdown -->
                <div class="ratings-breakdown" style="margin-bottom: 40px;">
                    <h3 style="font-size: 22px; margin-bottom: 20px;">Ratings</h3>
                    <div id="ratingsList"></div>
                </div>
                
                <!-- Reviews -->
                <div class="reviews-section" style="margin-bottom: 40px;">
                    <h3 style="font-size: 22px; margin-bottom: 20px;">Reviews</h3>
                    <div id="reviewsList"></div>
                </div>
                
                <!-- Booking Info -->
                <div class="booking-info" style="padding: 20px; background: #f5f5f5; border-radius: 12px; margin-bottom: 30px;">
                    <p id="cancellationPolicy" style="margin-bottom: 10px;"><strong>Cancellation Policy:</strong> <span style="margin-left: 10px;"></span></p>
                    <p style="margin-bottom: 10px;"><strong>Check-in:</strong> <span id="checkIn" style="margin-left: 10px;"></span></p>
                    <p style="margin-bottom: 0;"><strong>Check-out:</strong> <span id="checkOut" style="margin-left: 10px;"></span></p>
                </div>
                
                <!-- Reserve Button -->
                <button class="btn-reserve" onclick="alert('Booking feature coming soon!')" style="width: 100%; padding: 15px; background: #FF5A5F; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer;">
                    Reserve
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get property ID from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const propertyId = urlParams.get('id');
            
            if (propertyId) {
                displayPropertyDetails(propertyId);
            } else {
                window.location.href = '../index.html';
            }
        });
        
        function displayPropertyDetails(propertyId) {
            const property = InnStay.getPropertyDetails(propertyId);
            if (!property) {
                window.location.href = '../index.html';
                return;
            }
            
            // Populate basic info
            document.getElementById('propertyTitle').textContent = property.title;
            document.getElementById('propertyLocation').textContent = property.location;
            document.getElementById('propertyPrice').textContent = `$${property.price}`;
            document.getElementById('propertyDescription').textContent = property.description;
            
            // Rating
            document.getElementById('ratingStars').innerHTML = '‚òÖ'.repeat(Math.floor(property.rating)) + (property.rating % 1 ? '¬Ω' : '');
            document.getElementById('ratingReviews').textContent = `${property.rating} (${property.reviews} reviews)`;
            
            // Rooms info
            document.getElementById('bedrooms').textContent = `${property.bedrooms} bedroom${property.bedrooms !== 1 ? 's' : ''}`;
            document.getElementById('beds').textContent = `${property.beds} bed${property.beds !== 1 ? 's' : ''}`;
            document.getElementById('bathrooms').textContent = `${property.bathrooms} bathroom${property.bathrooms !== 1 ? 's' : ''}`;
            document.getElementById('guests').textContent = `${property.guests} guests`;
            
            // Images
            const mainImage = document.getElementById('mainImage');
            mainImage.src = property.images[0];
            
            const thumbnails = document.getElementById('thumbnails');
            thumbnails.innerHTML = property.images.map((img, idx) => `
                <img src="${img}" alt="Photo ${idx + 1}" class="${idx === 0 ? 'active' : ''}" onclick="changeMainImage('${img}', this)" style="cursor: pointer;">
            `).join('');
            
            // Amenities
            const amenitiesList = document.getElementById('amenitiesList');
            amenitiesList.innerHTML = property.amenities.map(amenity => `
                <div class="amenity-item" style="padding: 10px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-check" style="color: #484848;"></i>
                    <span>${amenity}</span>
                </div>
            `).join('');
            
            // Host info
            const host = property.host;
            document.getElementById('hostPhoto').src = host.photo;
            document.getElementById('hostName').textContent = host.name;
            document.getElementById('hostBadge').textContent = host.superhost ? '‚≠ê Superhost' : `Host for ${host.years} year${host.years !== 1 ? 's' : ''}`;
            document.getElementById('hostDetails').textContent = `${host.reviews} reviews ‚Ä¢ ${host.rating} rating`;
            document.getElementById('hostResponse').textContent = `Responds within ${host.responseTime} ‚Ä¢ ${host.responseRate} response rate`;
            
            // Ratings breakdown
            const ratingsList = document.getElementById('ratingsList');
            const breakdown = property.ratingBreakdown;
            const maxRating = 5;
            ratingsList.innerHTML = Object.entries(breakdown).map(([key, value]) => `
                <div class="rating-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #e0e0e0;">
                    <span class="rating-name" style="flex: 0 0 150px;">${key.charAt(0).toUpperCase() + key.slice(1)}</span>
                    <div class="rating-bar" style="flex: 1; height: 6px; background: #e0e0e0; border-radius: 3px; margin: 0 20px; overflow: hidden;">
                        <div class="rating-fill" style="width: ${(value / maxRating) * 100}%; height: 100%; background: #FF6E1A;"></div>
                    </div>
                    <span class="rating-value" style="flex: 0 0 50px; text-align: right;">${value.toFixed(1)}</span>
                </div>
            `).join('');
            
            // Reviews
            const reviewsList = document.getElementById('reviewsList');
            reviewsList.innerHTML = property.reviews_data.map(review => `
                <div class="review-card" style="padding: 20px 0; border-bottom: 1px solid #e0e0e0;">
                    <div class="review-header" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span class="reviewer-name" style="font-weight: bold;">${review.reviewer}</span>
                        <span class="review-date" style="color: #888;">${review.date}</span>
                    </div>
                    <div class="review-rating" style="color: #FF6E1A; margin-bottom: 10px;">‚òÖ${review.rating}</div>
                    <p class="review-text" style="color: #484848; line-height: 1.6;">${review.text}</p>
                </div>
            `).join('');
            
            // Booking info
            document.getElementById('cancellationPolicy').innerHTML = `<strong>Cancellation Policy:</strong> <span style="margin-left: 10px;">${property.cancellation}</span>`;
            document.getElementById('checkIn').textContent = property.checkIn;
            document.getElementById('checkOut').textContent = property.checkOut;
        }
        
        function changeMainImage(src, thumbnail) {
            document.getElementById('mainImage').src = src;
            document.querySelectorAll('.thumbnail-images img').forEach(img => img.classList.remove('active'));
            thumbnail.classList.add('active');
        }
    </script>
</body>
</html>
